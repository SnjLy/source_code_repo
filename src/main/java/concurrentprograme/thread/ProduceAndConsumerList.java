package concurrentprograme.thread;import com.alibaba.fastjson.JSON;import java.util.ArrayList;import java.util.List;/** * Created by yehao on 2017/4/5. */public class ProduceAndConsumerList {    public static void main(String args[]){        InfoFactory info = new InfoFactory(); // 实例化Info对象        Producer pro = new Producer(info) ; // 生产者        Consumer con = new Consumer(info) ; // 消费者        new Thread(pro).start() ;        //启动了生产者线程后，再启动消费者线程        try{            Thread.sleep(100) ;        }catch(InterruptedException e){            e.printStackTrace() ;        }        new Thread(con).start() ;    }}class InfoFactory{    private String name;    private String content;    //private boolean flag = true;  //true表示生产， false表示消费，不生产。    private List list = new ArrayList();    private static Integer len = 8;    public synchronized String set(String name, String content){        while (list.size()>=len) {            try {                super.wait();            } catch ( InterruptedException e ) {                e.printStackTrace();            }        }        InfoFactory infoFactory = new InfoFactory();        infoFactory.setName(name);        try {            Thread.sleep(300);        } catch ( InterruptedException e ) {            e.printStackTrace();        }        infoFactory.setContent(content);        System.out.println("producer:"+name +"***"+content);        list.add(infoFactory);       // flag = false; //改变标志位表示可以取走        super.notify();        return JSON.toJSONString(this);    }    public synchronized String get(){        while (list.size()<=0){            try {                super.wait();            } catch ( InterruptedException e ) {                e.printStackTrace();            }        }        try {            Thread.sleep(300);        } catch ( InterruptedException e ) {            e.printStackTrace();        }        //System.out.println(this.getName() + " --> " + this.getContent()) ;        //flag  = true ;  // 改变标志位，表示可以生产        int current = list.size()-1;        InfoFactory info =(InfoFactory)list.get(current);        System.out.println(JSON.toJSONString(info));        list.remove(current);        super.notify();        return JSON.toJSONString(this);    }    public String getName() {        return name;    }    public void setName(String name) {        this.name = name;    }    public String getContent() {        return content;    }    public void setContent(String content) {        this.content = content;    }}class Producer implements Runnable{ // 通过Runnable实现多线程    private InfoFactory info = null ;      // 保存Info引用+    public Producer(InfoFactory info){        this.info = info ;    }    public void run(){        boolean tag = true ;   // 定义标记位        for(int i=0;i<10;i++){            if(tag){                this.info.set("姓名--"+i,"内容--"+i) ;    // 设置名称                //tag = false ;            }else{                this.info.set("姓名--2","内容--2") ;    // 设置名称                tag = true ;            }        }    }}class Consumer implements Runnable{    private InfoFactory info = null ;    public Consumer(InfoFactory info){        this.info = info ;    }    public void run(){        for(int i=0;i<10;i++){            this.info.get() ;        }    }}